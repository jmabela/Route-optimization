{% extends 'base.html' %}
{% block title %}ROUTES HOME{% endblock %}

{% block body %}
<!DOCTYPE html>
<html>
<style>
    html,
body,
#map-canvas {
  height: 100%;
  width: 100%;
  margin: 0px;
  padding: 0px
}


</style>

<div class="topnav">  
</div>

<br>


<div id="map-canvas"></div>

<script>
    var sessionData = {{session|tojson}};



let placeIdList = sessionData["places_id"];


var map;
var infoWindow;
var service;

function initialize() {
  var mapOptions = {
    zoom: 2,
    center: new google.maps.LatLng(51.257195, 3.716563),
    scrollwheel: false,
    zoomControl: true,
    panControl: false,
    streetViewControl: false,
  };
  map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
  var infoWindow = new google.maps.InfoWindow();
  
for (var placeId in placeIdList){
    
    var placeId2= placeIdList[placeId];
  
  
  var service = new google.maps.places.PlacesService(map);
  service.getDetails({
    placeId: placeId2
  }, function(result, status) {
    if (status != google.maps.places.PlacesServiceStatus.OK) {
    //   alert(status);
      return;
    }
    var marker = new google.maps.Marker({
      map: map,
      position: result.geometry.location
    });

    marker.addListener('click', () => {
        infoWindow.close();
        infoWindow.setContent(result.adr_address);
        infoWindow.open(map, marker);
        });
 
    console.log(result.phots)
    var address = result.adr_address;
    var newAddr = address.split("</span>,");
    var photos=result.photos    
    // infoWindow.setContent(newAddr[0] + "<br>" + photos[1] + "<br>" );
    // infoWindow.open(map, marker);
  });
}

}

google.maps.event.addDomListener(window, 'load', initialize);

</script>

<script src="https://maps.googleapis.com/maps/api/js?v=3&libraries=places&key=AIzaSyCdKUZPbrSErfdmwL33htvJLDk0bcR5-2U&callback=initialize"></script>

</html>
{% endblock %}